Sub StockMarket():Dim i As LongDim Ticker As StringDim Year_Open As DoubleDim Total_Volume As DoubleTotal_Volume = 0Dim Yearly_Change As DoubleYearly_Change = 0Dim Percent_Change As DoubleDim PrintRow As LongPrintRow = 2Dim lastRow As LonglastRow = Cells(Rows.Count, 1).End(xlUp).Row'create headersCells(1, 10).Value = "Ticker"Cells(1, 11).Value = "Yearly Change"Cells(1, 12).Value = "Percent Change"Cells(1, 13).Value = "Total Stock Volume"Cells(1, 17).Value = "Value"Cells(1, 16).Value = "Ticker "Cells(2, 15).Value = "Greatest % Increase"Cells(3, 15).Value = "Greates % Decrease"Cells(4, 15).Value = "Greatest Total Volume"     Year_Open = Cells(2, 3).Value'loop de loopFor i = 2 To lastRow    If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then        Ticker = Cells(i, 1).Value        Yearly_Change = Yearly_Change + (Cells(i, 6).Value - Year_Open)        If Year_Open <> 0 Then            percentChange = (Yearly_Change / Year_Open)            Else            percentChange = 0        End If        Total_Volume = Total_Volume + Cells(i, 7).Value    ' input & format values            Range("J" & PrintRow).Value = Ticker        Range("K" & PrintRow).Value = Yearly_Change        Range("M" & PrintRow).Value = Total_Volume        Range("L" & PrintRow).Value = percentChange        Range("L" & PrintRow).NumberFormat = "0.00%"                        'set everything back to 0 for next loop        PrintRow = PrintRow + 1        Yearly_Change = 0        Total_Volume = 0        Year_Open = Cells(i + 1, 3).Value            Else        Total_Volume = Total_Volume + Cells(i, 7).Value            End IfNext iDim yearLastRow As LongyearLastRow = Cells(Rows.Count, 10).End(xlUp).Row'format loop for yearly change formattingFor i = 2 To yearLastRow'color formatting    If Cells(i, 11).Value >= 0 Then        Cells(i, 11).Interior.ColorIndex = 4    Else        Cells(i, 11).Interior.ColorIndex = 3    End IfNext i' variables for finding max & minDim percentLastRow As LongpercentLastRow = Cells(Rows.Count, 11).End(xlUp).RowDim percent_max As Doublepercent_max = 0Dim percent_min As Doublepercent_min = 0' Loop for finding max & minFor i = 2 To percentLastRow' Conditional for max & min    If percent_max < Cells(i, 12).Value Then        percent_max = Cells(i, 12).Value        Cells(2, 17).Value = percent_max        Cells(2, 17).Style = "Percent"        Cells(2, 16).Value = Cells(i, 10).Value    End If    If percent_min > Cells(i, 12).Value Then        percent_min = Cells(i, 12).Value        Cells(3, 17).Value = percent_min        Cells(3, 17).Style = "Percent"        Cells(3, 16).Value = Cells(i, 10).Value    End IfNext i'Find Greatest VolumeDim Total_VolumeRow As LongTotal_VolumeRow = Cells(Rows.Count, 12).End(xlUp).RowDim Total_VolumeMax As DoubleTotal_VolumeMax = 0'Loop for greatest total volumeFor i = 2 To Total_VolumeRow'greatest total volume    If Total_VolumeMax < Cells(i, 13).Value Then        Total_VolumeMax = Cells(i, 13).Value        Cells(4, 17).Value = Total_VolumeMax       Cells(4, 16).Value = Cells(i, 10).Value    End IfNext iEnd SubSub Runthrough2()    Dim xSh As Worksheet    Application.ScreenUpdating = False    For Each xSh In Worksheets        xSh.Select        Call StockMarket    Next    Application.ScreenUpdating = TrueEnd Sub